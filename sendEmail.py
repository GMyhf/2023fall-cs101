import pandas as pd

df = pd.read_excel('studentListInCourse-20230827.xls')
student_id = df['学号'].tolist()

sent_id = {
    1900014516, 1900018813, 2000012515, 2000013730, 2000017443, 2000017750, 2100011315, 2100011535, 2100014176,
    2100014191, 2100015122, 2100015452, 2100015873, 2100015898, 2100015938, 2100017433, 2100017479, 2100017732,
    2100017741, 2100017748, 2100017751, 2200013416, 2200013432, 2200013706, 2200013707, 2200013722, 2200013730,
    2200014112, 2200015151, 2200015438, 2200015467, 2200017430, 2200017437, 2200017708, 2200017752, 2200018112,
    2200091003, 2200093105, 2200094619, 2300011044, 2300011050, 2300011347, 2300011413, 2300011713, 2300011731,
    2300011743, 2300011805, 2300011851, 2300011854, 2300011859, 2300011869, 2300011890, 2300012254, 2300012265,
    2300012268, 2300013532, 2300011791, 2300011763, 2300011813, 2300011855, 2300010618, 2200015481, 2300011863,
    2300013556, 2300013530, 2300013558, 2200011462, 2000017757, 2300092807, 2300011538, 2300011724, 2300015940,
    2300093002, 1900017780, 2300011786, 2100017435, 2200015507, 2200091608, 2300013507, 2300013510, 2200017820,
    2300011061, 2300011075, 2300011407, 2300011774, 2300011853, 2300011451, 2300011456, 2300011505, 2300011507,
    2300011586, 2300011511, 2300011860, 2300010826, 2300011461, 2300011790, 2300010704, 2300011721, 2300011882,
    2300011883, 2300011733, 2300011783, 2300011797, 2300011812, 2300011723, 2300011756, 2300011527, 2300011708,
    2300011709, 2300011710, 2300011740, 2300011741, 2300011777, 2300011778, 2300011780, 2300011787, 2300011798,
    2300011864, 2300011871, 2300011878, 2300011880, 2300013423, 2300011612, 2300011717, 2300011746, 2300011775,
    2300011794, 2300011817, 2300011856, 2300011874, 2300011875, 2300011891, 2300011422, 2300011454, 2300011620,
    2300011732, 2300011734, 2300011744, 2300011867, 2300011876, 2300013508, 2300010770, 2300011508, 2300011585,
    2300011702, 2300011748, 2300011852, 2300013289, 2300013509, 2300013511, 2300011113, 2300011441, 2300011494,
    2300011503, 2300011510, 2300011868, 2300010604, 2300011480, 2300011751, 2300011412, 2300011452, 2300011739,
    2300013252, 2300010866, 2300011336, 2300011351, 2300011419, 2300011458, 2300011543, 2300011759, 2300013266,
    2300013408, 2300013433, 2300011366, 2300011770, 2300011865, 2300012290, 2300013288, 2300011172, 2300011704,
    2300011762, 2300011779, 2300011822, 2300012301, 2300013515, 2300013553, 2300013564, 2300017423, 2300017838,
    2300011329, 2300011621, 2300011725, 2300011887, 2300013561, 2300015897, 2300011079, 2300011091, 2300011158,
    2300012121, 2300012259, 2300011164, 2300011651, 2300011657, 2300012148, 2300011557, 2300011711, 2300011803,
    2300012118, 2300012273, 2300013430, 2300013569, 2300014110, 2300091101, 2200015470, 2300010748, 2300011338,
    2300011858, 2300011862, 2300011885, 2300013251, 2300017701, 2300010711, 2300011509, 2300011760, 2300011376,
    2300012603, 2300013414, 2300013420, 2300011526, 2300011119, 2300011406, 2300011524, 2300011726, 2300011737,
    2300012106, 2300012288, 2300011742, 2300013426, 2300011712, 2300012150, 2300013411, 2300011335, 2300012659,
    2300013271, 2300011030, 2300011168, 2300011193, 2300012154, 2300012115, 2300012285, 2300011016, 2300011057,
    2300011072, 2300011081, 2300011745, 2300012153, 2300011027, 2300011058, 2300012286, 2300012123, 2300012142,
    2300012303, 2300011121, 2300013504, 2300017711, 2300012105, 2300012156, 2300013429, 2300091105, 2300011402,
    2310307203, 2300011106, 2300011476, 2300012139, 2300012295, 2300015881, 2300012107, 2300012122, 2300012289,
    2300017744, 2300011159, 2300011727, 2300011728, 2300012304, 2300012144, 2300011619, 2300011654, 2300011707,
    2300012302, 2300011031, 2300011111, 2300011056, 2300011705, 2300012261, 2300011574, 2300013264, 2300090402,
    2300012267,

}

print(len(sent_id))

res1 = []
res2 = []
for i in student_id:
    if i in sent_id:
        continue

    res2.append(i)
    if i < 2e9:
        res1.append(f"{i}@pku.edu.cn")
    else:
        res1.append(f"{i}@stu.pku.edu.cn")

print(','.join(res1))
print(', '.join(map(str, res2)))

'''
我是mac机器，可以这样发送，但是北大邮箱总把收到的邮件归到Spam里面。
(cat mail.txt; uuencode 20230820-Wechat.jpg 20230820-Wechat.jpg)|mail -s "202308 计算概论（B）（12班）课程微信群" x@pku.edu.cn

所以我现在是程序输出要发送同学的邮箱地址列表，拷贝下来，在浏览器邮件里面发送。
'''
